# Tensorflow构建神经网络识别手写数字
---
在前面的文章中，我们针对MNIST数据集以及神经网络进行了简单的介绍，本文在此基础上，将针对MNIST数据集，利用Tensorflow构建一个神经网络，训练网络对MNIST手写数字进行识别。

* ###首先，我们导入相关python模块以及MNIST数据集。

![](/assets/TIM截图20180501004018.png)

“one_hot=True”表示用0,1元素组成的长度为10的向量表示标签数字0~9。比如数字3表示成[0,0,0,1,0,0,0,0,0,0],数字3为向量中元素1的索引。

* ###定义神经网络的输入输出以及隐藏层的参数。
![](/assets/微信截图_20180509144728.png)

其中，**tf.palceholder()**定义一个占位符，从内存中读入数据（关于tensorflow读取数据我们会在相关章节作专门的详细讲解）。**tf.nn.softmax()**的输入是一个向量，输出是一个归一化后的向量，用于计算向量中各个元素占元素总和的权重。例如，向量 A = $$[a1, a2, a3]$$,那么**tf.nn.softmax(A)**的输出为$$[a1/∑ai, a2/∑ai,a3/∑ai]$$(其中，$$∑ai = a1 + a2 +a3$$)。

1. 神经网络的输入x为[None,784],第一个为输入的图片数量，每张大小为784。由于暂不确定张数，用None占位。比如我们输入100张图片，那么x为100*784矩阵。

2. 神经网络的输入y\_为[None,10],第一个为输入的数字标签数量，上面我们说过，每个数字标签是一个长度为10的由0,1组成的数组。所以若我们输入100个数字标签，那么y\_为100*10矩阵。输入的图片（images）与标签（labels）数量相等，一一对应。

3. 隐藏层参数w为[784,10]矩阵，784行，10列。这儿的10可以理解是标签数字是一个十分类问题。b为长度为10的向量。w和b初始值我们这儿用0填充，调用**tf.zeros()**函数。
4. 神经网络的输出层y为 $$y = x*w + b$$,然后我们将y用**tf.nn.softmax()**映射到（0,1）范围内。用代码表示，输出层 **y = tf.nn.softmax(tf.matmul(x,w)+b)**。


* ###定义损失函数，训练神经网络。
![](/assets/微信截图_20180509202308.png)

损失函数 $$loss = ∑(y-y\_)²$$,用代码实现为**loss = tf.reduce_sum(tf.square(y-y__))**。如果神经网络对图片数字识别准确，那么y中权值最大的索引号与标签数字的对应的向量中1的索引号一致。即就是说，loss函数理论上取得一个比较小的值（权值小的值减去0，权值最大的值减去1,然后差的平方求和）。

**train_step =  tf.train.GradientDescentOptimizer(0.001).minimize(loss)**是指以0.001为学习率进行梯度下降，已达到loss局部最小化值。tensorflow的梯度下降函数会自动进行反向传播更新w和b的值，这一点无需我们自己去实现。



